<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/header :: header('Usuarios')">
<meta charset="utf-8" />

</head>

<body id="page-top" class="sidebar-toggled">
	<nav th:replace="fragments/nav :: nav('card-0-nav')"></nav>
	<nav th:replace="fragments/secondarynav"></nav>

	<div id="wrapper">
		<div id="content-wrapper">
			<div class="container-fluid">
				<div class="region-hero">
					<div class="contenedor-hero">
						<div class="contenido-hero">
							<h1 id="titulo" class="titulo-hero" th:text="${titulo}"></h1>
							Usuarios Actuales del GRI
						</div>
					</div>
				</div>



				<div class="separador-1"></div>

				<a class="btn btn-primary" id="btnCrearUsuario">Crear Usuario</a> <br />
				<br />
				<div class="contenedor mb-3">
					<div class="contenedor-header">
						<i class="fas fa-table"></i> Lista de Usuarios
					</div>
					<div class="contenedor-body">
						<div id="table">
							<table id="tabla_usuarios"
								th:class="'table-' + ${id} + ' table-striped table-bordered table-hover table-responsive-lg'"
								style="width: 100%">
								<thead>
									<tr>


										<th class="centrarItemsTabla">NOMBRE DE USUARIO</th>
										<th class="centrarItemsTabla">ROL</th>
										<th class="centrarItemsTabla">ACCIONES</th>


									</tr>
								</thead>
								<tbody>

									<tr th:each="usuario : ${usuarios}">

										<td class="centrarItemsTabla" th:text="${usuario.username}"></td>
										<td class="centrarItemsTabla" th:text="${usuario.rol.role}"></td>
										<td class="centrarItemsTabla">
											<a class="btn btn-warning" th:onclick="editarUsuario([[${usuario.username}]],[[${usuario.rol.role}]],[[${usuario.password}]],[[${usuario.id}]]);" >Editar</a>
											<a th:href="'usuarios/delete/'+${usuario.id}"
											class="btn btn-danger">Eliminar</a>
										</td>

									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
	<div th:replace="fragments/footer"></div>
	<div th:include="admin/users/save.html"></div>



</body>

<script type="text/javascript" th:inline="javascript">
		var data = [[${ usuarios }]];
		console.log(data);
		console.log(data.length);
		$.extend($.fn.dataTable.defaults, {
			
			language: {
				processing: "Procesamiento en curso...",
				search: "Buscar: ",
				lengthMenu: "Mostrando _MENU_ elementos",
				info: "Mostrando _START_ a _END_ de _TOTAL_ elementos",
				infoEmpty: "Mostrando 0 a 0 de 0 elementos",
				infoFiltered: "(filtrado de _MAX_ elementos en total)",
				infoPostFix: "",
				loadingRecords: "Cargando resultados...",
				zeroRecords: "No hay información para mostrar",
				emptyTable: "No hay información para mostrar",
				paginate: {
					first: "Primera",
					previous: "Anterior",
					next: "Siguiente",
					last: "última"
				}
			}
		});

		let modalUsuario = document.getElementById("agregarUsuariosModal");
		
		let span = document.getElementsByClassName("closeModalUsuario")[0];
		let body = document.getElementsByTagName("body")[0];
	
		$(document).ready(function() {
			
			$('#btnCrearUsuario').on('click', function(e) {
				
				modalUsuario.style.display = "block";

				body.style.position = "static";
				body.style.height = "100%";
				body.style.overflow = "hidden";
				
				$('#idTitleCrearUsuario').text('Crear Usuario');
				
				
			});
			
			$('.closeModalUsuario').on('click', function(e) {
			
			
				modalUsuario.style.display = "none";

				body.style.position = "inherit";
				body.style.height = "auto";
				body.style.overflow = "visible";
			})
			
			window.onclick = function(event) {
				if (event.target == modalUsuario) {
					modalUsuario.style.display = "none";

					body.style.position = "inherit";
					body.style.height = "auto";
					body.style.overflow = "visible";
				}
			}
			
			
		});
		
		function editarUsuario(username, rol, password, id){
			
			$('#usernameUsuario').val(username);
			$('#passwordUsuario1').val(password);
		
			document.getElementById("rol.role").value = '1';
			alert($("#rol.role").val())
			$('#campoid').val(id);
			
			
			modalUsuario.style.display = "block";

			body.style.position = "static";
			body.style.height = "100%";
			body.style.overflow = "hidden";
			
			$('#idTitleCrearUsuario').text('Editar Usuario');
			
			
		}


	</script>
</html>